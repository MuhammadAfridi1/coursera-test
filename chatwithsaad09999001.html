<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat App</title>
    <style>
        /* Your CSS styles */
    </style>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
        import { getDatabase, ref, onChildAdded, push, remove, get } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-database.js";
        import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-storage.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const storage = getStorage(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Function to sign in with Google
        function signInWithGoogle() {
            signInWithPopup(auth, provider)
                .then((result) => {
                    const user = result.user;
                    console.log('User signed in:', user);
                })
                .catch((error) => {
                    console.error('Error signing in:', error);
                    alert('Error: ' + error.message);
                });
        }

        // Make signInWithGoogle globally accessible
        window.signInWithGoogle = signInWithGoogle;

        // Function to sign out
        function signOutUser() {
            signOut(auth).then(() => {
                console.log('User signed out');
            }).catch((error) => {
                console.error('Error signing out: ', error);
            });
        }

        // Make signOutUser globally accessible
        window.signOutUser = signOutUser;

        // Monitor authentication state
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('chat-area').classList.remove('hidden');
                document.getElementById('google-sign-in').classList.add('hidden');
                document.getElementById('sign-out-button').classList.remove('hidden');
            } else {
                document.getElementById('chat-area').classList.add('hidden');
                document.getElementById('google-sign-in').classList.remove('hidden');
                document.getElementById('sign-out-button').classList.add('hidden');
            }
        });

        // Other functions like loadMessages, sendMessage, uploadFile, clearChat...
    </script>
</head>
<body>
    <h1>Chat Application</h1>
    <div id="sign-in-area">
        <button id="google-sign-in" onclick="signInWithGoogle()">Sign in with Google</button>
        <button id="sign-out-button" onclick="signOutUser()" class="hidden">Sign out</button>
    </div>
    
    <div id="chat-area" class="hidden">
        <h3>Chat Messages</h3>
        <div id="chat-box" class="chat-box"></div>
        <input type="text" id="chat-input" placeholder="Type a message..." />
        <button onclick="sendMessage()">Send</button>
        <button onclick="clearChat()">Clear Chat</button>
        <input type="file" id="file-input" />
        <button id="upload-button" onclick="uploadFile()">Upload</button>
    </div>
</body>
</html>
